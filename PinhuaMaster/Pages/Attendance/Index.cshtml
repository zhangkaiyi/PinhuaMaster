@page
@model PinhuaMaster.Pages.Attendance.IndexModel
@{
    ViewData["Title"] = "考勤报表";
}

<div id="toolbar">
    <a asp-page="Test" class="btn btn-default">生成新报表</a>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="box box-solid">
            <div class="box-body">
                <table data-toggle="table"
                       data-toolbar="#toolbar"
                       class="table table-striped table-hover"
                       style="white-space:nowrap">
                    <thead>
                        <tr>
                            <th data-width="10"></th>
                            <th>年月</th>
                            <th>总人数</th>
                            <th>总工时</th>
                            <th>总用餐</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Reports)
                        {
                            <tr>
                                <td><a asp-page="Details" asp-route-y="@item.Report.Y" asp-route-m="@item.Report.M"><i class="fa fa-search"></i></a></td>
                                <td>@(item.Report.Y) - @(item.Report.M.ToString("D2"))</td>
                                <td>@(item.Details.Count())</td>
                                <td>@(item.Details.Sum(p => p.总工时)?.ToString("0.0"))</td>
                                <td>@(item.Details.Sum(p => p.用餐))</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div id="test">
    <select class="form-control" v-model="S1" v-on:change="aa">
        <option v-for="(item, index) in ABC" :value="item.value">{{item.label}}</option>
    </select>
    <select class="form-control" v-model="S2">
        <option v-for="(item, index) in ABC2" :value="item.value">{{item.label}}</option>
    </select>
</div>

@section Scripts{
    <script>
        vm = new Vue({
            el: '#test',
            methods: {
                aa: function () {
                    var tempCity = [];
                    this.ABC2 = [];
                    this.S2 = '';  
                    for (var item of this.ABC) {
                        if (item.value == this.S1) {
                            for (var child of item.children) {
                                tempCity.push(child)

                            }
                        }

                    }
                    this.ABC2 = tempCity;
                }
            },
            data: {
                ABC: [{
                    value: 'beijing',
                    label: '北京',
                    children: [{
                        value: 'chaoyang',
                        label: '朝阳'
                    }, {
                        value: 'haidian',
                        label: '海淀'
                    }, {
                        value: 'changping',
                        label: '昌平'
                    }, {
                        value: 'shunyi',
                        label: '顺义'
                    }]
                }, {
                    value: 'shanghai',
                    label: '上海',
                    children: [{
                        value: 'baoshan',
                        label: '宝山'
                    }, {
                        value: 'jiading',
                        label: '嘉定'
                    }, {
                        value: 'songjiang',
                        label: '松江'
                    }, {
                        value: 'pudong',
                        label: '浦东'
                    }]
                    }],
                ABC2:[],
                S1: "",
                S2: ""

            }
        })
    </script>
}